<!DOCTYPE html>
<html>
   <head>
       <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

       <title>Babylon.js sample code</title>

       <!-- Babylon.js -->
       <script src="https://code.jquery.com/pep/0.4.2/pep.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.2/dat.gui.min.js"></script>
       <script src="https://preview.babylonjs.com/ammo.js"></script>
       <script src="https://preview.babylonjs.com/cannon.js"></script>
       <script src="https://preview.babylonjs.com/Oimo.js"></script>
       <script src="https://preview.babylonjs.com/gltf_validator.js"></script>
       <script src="https://preview.babylonjs.com/earcut.min.js"></script>
       <script src="https://preview.babylonjs.com/babylon.js"></script>
       <script src="https://preview.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>
       <script src="https://preview.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
       <script src="https://preview.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
       <script src="https://preview.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
       <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.js"></script>
       <script src="https://preview.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
       <script src="https://preview.babylonjs.com/gui/babylon.gui.min.js"></script>
      <script src="https://preview.babylonjs.com/loaders/babylon.glTFFFileLoader.js"></script>

       <style>
           html, body {
               overflow: hidden;
               width: 100%;
               height: 100%;
               margin: 0;
               padding: 0;
           }

           #renderCanvas {
               width: 100%;
               height: 100%;
               touch-action: none;
           }
       </style>
   </head>
<body>
   <canvas id="renderCanvas"></canvas>
   <script>
       var canvas = document.getElementById("renderCanvas");

   var createScene = function () {
            var scene = new BABYLON.Scene(engine);
            var camera = new BABYLON.ArcRotateCamera("Camera", -Math.PI / 2,  Math.PI / 2, 5, BABYLON.Vector3.Zero(), scene);
            camera.attachControl(canvas, true);
            camera.inputs.attached.mousewheel.detachControl(canvas);
            
            //for VR
            var vrHelper = scene.createDefaultVRExperience();
           vrHelper.enableInteractions();
            var leftHand = BABYLON.Mesh.CreateBox("",0.1, scene)
            leftHand.scaling.z = 2;
            //
           var redMat = new BABYLON.StandardMaterial("red", scene);
    redMat.diffuseColor = new BABYLON.Color3(255, 0, 0);
    redMat.emissiveColor = new BABYLON.Color3(255, 0, 0);
    redMat.specularColor = new BABYLON.Color3(255, 0, 0);
   var sphere = BABYLON.Mesh.CreateSphere("sphere1", 16, 1, scene);
   sphere.material = redMat;
   sphere.position.x = 1;
   sphere.position.y = 0;
   sphere.position.z = 0; 
        
        vrHelper.webVRCamera.initControllers();
     
        /*var gamepad = window.navigator.getGamepads();
        gamepad.onControllerMeshLoaded*/
       /* var gamepadManager = new BABYLON.GamepadManager();
        gamepadManager.onGamepadConnectedObservable.add((gamepad, state)=>{
        gamepad.onButtonDownObservable.add((button, state)=>{
        //Button has been pressed
            sphere.material = null;
        })});*/
            //for VR
            scene.onBeforeRenderObservable.add(()=>{
                //It has not worked yet.
                if(vrHelper.webVRCamera.leftController){
                    leftHand.position = vrHelper.webVRCamera.leftController.devicePosition.clone()
                    leftHand.rotationQuaternion = vrHelper.webVRCamera.leftController.deviceRotationQuaternion.clone()
                }
            });
            vrHelper.onControllerMeshLoaded.add((webVRController)=>{
                var controllerMesh = webVRController.mesh;
                webVRController.onPadStateChangedObservable.add(() => {sphere.material = null;});
                webVRController.onTriggerStateChangedObservable.add(()=>{
                   sphere.material = null;
                });
            });
            //
        
            return scene;
        };

       



         
      
      
       var engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });
       var scene = createScene();

       engine.runRenderLoop(function () {
           if (scene) {
               scene.render();
           }
       });

       // Resize
       window.addEventListener("resize", function () {
           engine.resize();
       });
   </script>
</body>
</html>


