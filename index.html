<!DOCTYPE html>
<html>
   <head>
       <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

       <title>Babylon.js sample code</title>

       <!-- Babylon.js -->
       <script src="https://code.jquery.com/pep/0.4.2/pep.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.2/dat.gui.min.js"></script>
       <script src="https://preview.babylonjs.com/ammo.js"></script>
       <script src="https://preview.babylonjs.com/cannon.js"></script>
       <script src="https://preview.babylonjs.com/Oimo.js"></script>
       <script src="https://preview.babylonjs.com/gltf_validator.js"></script>
       <script src="https://preview.babylonjs.com/earcut.min.js"></script>
       <script src="https://preview.babylonjs.com/babylon.js"></script>
       <script src="https://preview.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>
       <script src="https://preview.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
       <script src="https://preview.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
       <script src="https://preview.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
       <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.js"></script>
       <script src="https://preview.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
       <script src="https://preview.babylonjs.com/gui/babylon.gui.min.js"></script>
      <script src="https://preview.babylonjs.com/loaders/babylon.glTFFFileLoader.js"></script>

       <style>
           html, body {
               overflow: hidden;
               width: 100%;
               height: 100%;
               margin: 0;
               padding: 0;
           }

           #renderCanvas {
               width: 100%;
               height: 100%;
               touch-action: none;
           }
       </style>
   </head>
<body>
   <canvas id="renderCanvas"></canvas>
   <script>
       var canvas = document.getElementById("renderCanvas");

       var timer;
      
 var createScene = function () {
 
 
  var scene = new BABYLON.Scene(engine);
   var camera = new BABYLON.ArcRotateCamera("Camera", -Math.PI / 2,  Math.PI / 2, 5, BABYLON.Vector3.Zero(), scene);
   camera.attachControl(canvas, true);
   camera.inputs.attached.mousewheel.detachControl(canvas);
     
   var vrHelper = scene.createDefaultVRExperience();
  
    vrHelper.displayGaze = true ;
    vrHelper.displayLaserPointer = true;
    vrHelper.changeGazeColor(new BABYLON.Color3(1,1,1));
   /*vrHelper.gazeTrackerMesh = BABYLON.Mesh.CreateSphere("sphere1", 16, 0.05, scene);
   vrHelper.updategazetrackerscale = true;*/
    vrHelper.enableInteractions();
  
   
   var dome = new BABYLON.PhotoDome(
       "testdome",
       "./360photo.jpg",
       {
           resolution: 32,
           size: 1000
       },
       scene
   );
   
  var redMat = new BABYLON.StandardMaterial("red", scene);
    redMat.diffuseColor = new BABYLON.Color3(255,255, 0);
    redMat.emissiveColor = new BABYLON.Color3(255, 255, 0);
    redMat.specularColor = new BABYLON.Color3(255, 255, 0);
   var sphere = BABYLON.Mesh.CreateSphere("sphere1", 16, 1, scene);
   sphere.material = redMat;
   sphere.position.x = 1;
   sphere.position.y = 0;
   sphere.position.z = 0; 
 
 
  var advancedTexture = BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("UI");
   var rect1 = new BABYLON.GUI.Rectangle();
   rect1.width = 0.1;
   rect1.height = "20px";
   rect1.cornerRadius = 20;
   rect1.color = "black";
   rect1.thickness = 2;
   rect1.background = "white";
   advancedTexture.addControl(rect1);
   var label = new BABYLON.GUI.TextBlock();
   label.text = "EntrÃ©e";
   rect1.addControl(label);
   rect1.linkWithMesh(sphere);  
   rect1.linkOffsetY = -50;
 
   
  
   /*------------------------------VIDEO------------------------------------*/

  
var plane = BABYLON.Mesh.CreatePlane("plane1", 2, scene);
plane.isVisible = false;
     sphere.actionManager = new BABYLON.ActionManager(scene);
    var show = true;
     sphere.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickUpTrigger, function () {
        
        if(show)
        {
            plane.isVisible = true;
         var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 0.7;
	
    // Create a material from the video
	var mat = new BABYLON.StandardMaterial("mat", scene);
	var videoTexture = new BABYLON.VideoTexture("video", ["./babylonjs.mp4"], scene, true, false,);
	mat.diffuseTexture = videoTexture;
   
    // Attach the video material the a mesh
    
    plane.scaling.x = 1920/1080; // set aspect ratio
    plane.position.x = 1;
    plane.position.y = 2; 
    plane.position.z = 0;
	plane.material = mat;
	
    // Access video for play/pause
    plane.actionManager = new BABYLON.ActionManager(scene); 
    var playing = false;
    plane.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickUpTrigger, function () {
        if(playing)
        {
       videoTexture.video.play();
       playing = !playing;
        }
        else
        {
            videoTexture.video.pause();
            playing = !playing;
        }
     
    }));
        show = !show;
        }
        else 
        {
            show = !show;
            plane.dispose()

          
        }
	
	 

   
   }));
  /*
    sphere.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger, function () {
         var gamepadManager = new BABYLON.GamepadManager();
        gamepadManager.onGamepadConnectedObservable.add((gamepad, state)=>{
        gamepad.onButtonDownObservable.add((button, state)=>{
        
    
     
        if(show)
        {
            plane.isVisible = true;
         var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 0.7;
	
    // Create a material from the video
	var mat = new BABYLON.StandardMaterial("mat", scene);
	var videoTexture = new BABYLON.VideoTexture("video", ["./babylonjs.mp4"], scene, true, false,);
	mat.diffuseTexture = videoTexture;
   
    // Attach the video material the a mesh
    
    plane.scaling.x = 1920/1080; // set aspect ratio
    plane.position.x = 1;
    plane.position.y = 2; 
    plane.position.z = 0;
	plane.material = mat;
	
    // Access video for play/pause
    plane.actionManager = new BABYLON.ActionManager(scene); 
    var playing = false;
    plane.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickUpTrigger, function () {
         gamepadManager.onGamepadConnectedObservable.add((gamepad, state)=>{
        gamepad.onButtonDownObservable.add((button, state)=>{
        
        if(playing)
        {
       videoTexture.video.play();
       playing = !playing;
        }
        else
        {
            videoTexture.video.pause();
            playing = !playing;
        }
     })});
    }));
        show = !show;
        }
        else 
        {
            show = !show;
            plane.dispose()

          
        }
	gamepadManager.dispose();

      })});
   })); */
	
	 
	   var gamepadManager = new BABYLON.GamepadManager();
        gamepadManager.onGamepadConnectedObservable.add((gamepad, state)=>{
        gamepad.onButtonDownObservable.add((button, state)=>{
        
    
     
        if(show)
        {
            plane.isVisible = true;
         var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 0.7;
	
    // Create a material from the video
	var mat = new BABYLON.StandardMaterial("mat", scene);
	var videoTexture = new BABYLON.VideoTexture("video", ["./babylonjs.mp4"], scene, true, false,);
	mat.diffuseTexture = videoTexture;
   
    // Attach the video material the a mesh
    
    plane.scaling.x = 1920/1080; // set aspect ratio
    plane.position.x = 1;
    plane.position.y = 2; 
    plane.position.z = 0;
	plane.material = mat;
	
    // Access video for play/pause
    plane.actionManager = new BABYLON.ActionManager(scene); 
    var playing = false;
    plane.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickUpTrigger, function () {
        
        
        if(playing)
        {
       videoTexture.video.play();
       playing = !playing;
        }
        else
        {
            videoTexture.video.pause();
            playing = !playing;
        }
     
    }));
        show = !show;
        }
        else 
        {
            show = !show;
            plane.dispose()

          
        }
	//gamepadManager.dispose();

      })});
   return scene;
};

       



         
      
      
       var engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });
       var scene = createScene();

       engine.runRenderLoop(function () {
           if (scene) {
               scene.render();
           }
       });

       // Resize
       window.addEventListener("resize", function () {
           engine.resize();
       });
   </script>
</body>
</html>


